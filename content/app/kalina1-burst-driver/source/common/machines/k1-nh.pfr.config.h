#if (!defined(fb3_burst_prf_config_hpp)) && defined(fb3_burst_common_h)
#define fb3_burst_prf_config_hpp
#else
#error error of using k1-nh.prf.config.hpp
#endif

#define K1_CPU_FREQ_HZ 168000000LL
#define K1_ADC_CURRENT_SENCE_TIME_US 6
#define K1_DEAD_TIME 64
//#define K1_CURRENT_SENCE_ENABLED 0
//#define K1_ROTOR_ENCO_TYPE K1_ROTOR_ENCO_TYPE_NONE
//#define K1_ROTOR_POSITION_SENCE_TYPE K1_ROTOR_POSITION_SENCE_TYPE_NONE
//#define K1_SERIAL_TYPE K1_SERIAL_TYPE_NONE

//#define adc_INDEX 

#define FMSTR_REC_TIMEBASE (32768+K1_CONTROL_PERIOD_US)
#define FMSTR_REC_BUFF_SIZE 4000

#define motor_INV3PH_NATIVE_RANGE_LO						0
#define motor_INV3PH_NATIVE_RANGE_HI						(K1_PWM_MODULO-K1_ADC_DELAY)
#define motor_INV3PH_PWM_FORCE									600

#define motor_RANGE_VOLTAGE_LO									BURST_SIGNAL_MIN
#define motor_RANGE_VOLTAGE_HI									BURST_SIGNAL_MAX
#define motor_LATERAL_VOLTAGE_RANGE_LO					BURST_SIGNAL_MIN
#define motor_LATERAL_VOLTAGE_RANGE_HI					BURST_SIGNAL_MAX
#define BURST_ADC_CHANNEL_COUNT 3
#define adc_INDEX {0,1,2}
#define adc_SCALE {-1,-1,-1}

#define swt_CONFIG_GAIN_PROP 1
#define swt_CONFIG_GAIN_MODEL 1
#define swt_CONFIG_PWM_RAMP32 1
#define swt_CONFIG_PWM_MIN 0
#define swt_CONFIG_PWM_MAX K1_PWM_MODULO-1
#define swt_CONFIG_SECTOR_OFFSET 0

//#define motor_CURRENT3PH_DEFORM { 42234,   -36409,   -5825, -29127,    36409,   -7282,   -11651,   -18204,    29855}

#define motor_CURRENT3PH_DEFORM  	{\
     	26124, -55714 ,-28673, \
     	-56212, 63589, -19930, \
     	30088, -7875, 48603\
}


#define K1_BOARD_TEMPER_SENCE_REFER_VOLT 0.76
#define K1_BOARD_TEMPER_SENCE_REFER_TEMPER 25
#define K1_BOARD_TEMPER_SENCE_grad2mVolt 2.5

#define K1_BOARD_TEMPER_PP_TO_GRAD( pp )\
(\
	(\
		(int) (K1_BOARD_TEMPER_SENCE_REFER_TEMPER*65536 - 0.76*4096*1000*16/K1_BOARD_TEMPER_SENCE_grad2mVolt)\
		+(int) (3.3* 1000*16/K1_BOARD_TEMPER_SENCE_grad2mVolt)*pp +32767\
	)>>16\
)


#define K1_BOARD_TEMPER_GRAD_TO_PP( gr )\
(\
	(\
		(int)(K1_BOARD_TEMPER_SENCE_REFER_VOLT/3.3*4098*65536  - K1_BOARD_TEMPER_SENCE_REFER_TEMPER*K1_BOARD_TEMPER_SENCE_grad2mVolt/1000/3.3*4098*65536)\
		+ (int)(K1_BOARD_TEMPER_SENCE_grad2mVolt/1000/3.3*4098*65536) * gr\
	)>>16\
)


#define BURST_PANICS_MASTER_LOST_ENABLED 1
#define motor_REF_ALIVE_PERIOD_US 1000
		
#define BURST_PANICS_BOARD_TEMPER_ENABLED 1
#define BURST_PANICS_BOARD_OVERTEMP_PP K1_BOARD_TEMPER_GRAD_TO_PP(110)
#define BURST_PANICS_BOARD_LOTEMP_PP K1_BOARD_TEMPER_GRAD_TO_PP(-25)
		
#define K1_BOARD_MVOLT_TO_PP(x) (x)
#define BURST_PANICS_BOARD_VOLTAGE_ENABLED 1
#define BURST_PANICS_BOARD_OVERVOLTAGE_PP K1_BOARD_MVOLT_TO_PP(60)
#define BURST_PANICS_BOARD_LOVOLTAGE_PP K1_BOARD_MVOLT_TO_PP(24)
